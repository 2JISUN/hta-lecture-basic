<%@page import="com.google.gson.Gson"%>
<%@page import="java.util.Map"%>
<%@page import="java.util.HashMap"%>
<%@page import="java.sql.ResultSet"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="common.JDBCConnect"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%
	//HTTP 응답의 Content-Type 헤더를 설정하는 부분
	//역할 : 클라이언트에게 전송되는 데이터의 형식과 문자 인코딩을 명시적으로 지정
	//목적 : 이를 통해 데이터의 정확한 해석과 처리가 가능해집니다.
	response.setContentType("application/json; charset=utf-8");


	//0.전역변수 할당
	//get : request.getParameter를 사용하여 사용자가 입력한 정보를 받아옵니다.
		String userID = 
			request.getParameter("userID");
	
		//1. driver 찾기
		//2. db연동
	JDBCConnect jdbcConn =  
			new JDBCConnect();

	
	String sql = 
	"select count(*) AS count from member where id = ?";
	PreparedStatement pstmt =  
	jdbcConn.conn.prepareStatement(sql);
	pstmt.setString(1, userID);
	ResultSet rs = pstmt.executeQuery();
	int result = 0;
	if(rs.next()){
		result = rs.getInt("count");
	}
	
	Map<String,Integer> map = 
			new HashMap<>();
	map.put("count",result);
	Gson gson = new Gson();
	String json = gson.toJson(map);
	out.println(json);
	// Spring은 이걸 내장하고 있음...
%>







